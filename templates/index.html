<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <h1>Leaderboard</h1>
    <label for="server-select">Choisissez un serveur :</label>
    <select id="server-select">
        <option value="Tiliwan1">Tiliwan1</option>
        <option value="Tiliwan2">Tiliwan2</option>
        <option value="Oshimo">Oshimo</option>
        <option value="Herdegrize">Herdegrize</option>
        <option value="Euro">Euro</option>
    </select>

    <table>
        <thead>
            <tr>
                <th>Nom d'utilisateur</th>
                <th>Victoires</th>
                <th>Défaites</th>
                <th>Mises totales</th>
                <th>Participation (%)</th>
            </tr>
        </thead>
        <tbody id="leaderboard-body">
            <tr>
                <td colspan="5">Chargement...</td>
            </tr>
        </tbody>
    </table>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function loadLeaderboardData(server) {
            $.get(`/api/leaderboard?server=${server}`, function(data) {
                const tbody = $('#leaderboard-body');
                tbody.empty();

                if (data && data.utilisateurs) {
                    for (const userId in data.utilisateurs) {
                        const user = data.utilisateurs[userId];
                        const row = `<tr>
                            <td>${user.username}</td>
                            <td>${user.total_wins}</td>
                            <td>${user.total_losses}</td>
                            <td>${user.total_bets}</td>
                            <td>${user.participation}%</td>
                        </tr>`;
                        tbody.append(row);
                    }
                } else {
                    tbody.append(`<tr><td colspan="5">Aucune donnée disponible</td></tr>`);
                }
            }).fail(function() {
                alert('Erreur lors de la récupération des données.');
            });
        }

        $('#server-select').on('change', function() {
            const selectedServer = $(this).val();
            loadLeaderboardData(selectedServer);
        });

        // Charger les données du serveur par défaut au démarrage
        loadLeaderboardData('Tiliwan1');
    </script>
</body>
</html>
